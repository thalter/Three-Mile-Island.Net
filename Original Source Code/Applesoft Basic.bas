    0 LOMEM:3072
    1 SCNT=DCNT=CNT=OTMP=TEMP:TMP0=TMP1=TMP2=TMP3=TMP4
    2 VFLG=UFLG=TFLG=FFLG=EFLG
    3 UC1=UC2=UC3=UC4=UC5=UC6=UC7=UC8
    4 EOUT=COST=MAIN=DMND=ACTP=MAXP
    5 AIR=FCNT=TCNT
   10 DIM VC(19),VA(19)
   15 DIM VP(19),PI(25)
   20 DIM UC(24),PU(24)
   25 DIM TC(4),TU(4)
   30 DIM SC(3),FI(3),SL(3)
   32 DIM GC(11)
   35 DIM BU(11),BO(11)
   40 DIM SP(3)
   45 DIM FR(18),CR(18),CRC(18),CCR(2)
   50 DIM CMMD$(110),LET$(30),LN$(40),SP$(40)
   65 DIM FCOL(4)
   75 DIM CX(18),CY(18)
   80 SPK=-16336:BELL=-198
   85 DEL 0,85
   90 GOSUB 32000
  100 DYN=-1: TEXT : CALL -936
  110 GOSUB 8000: GOSUB 3700
  115 GOSUB 1400: IF KB=27 THEN 115
  120 KB=KB-48: IF KB<0 OR KB>7 THEN 100
  130 DYN=KB: GOSUB 200+DYN*100: GOTO 120
  200 GR : CALL -936
  205 GOSUB 10000: GOSUB 10600
  207 GOSUB 10700: GOSUB 10100
  210 GOSUB 10200: GOSUB 10300
  215 GOSUB 10400: GOSUB 10500
  220 GOSUB 10900: GOSUB 8100
  235 GOSUB 1400
  252 IF KB=16 THEN GOSUB 8100
  253 IF KB=22 THEN GOSUB 8110
  260 KB=KB-64
  265 IF LAB=1 AND KB>0 AND KB<7 THEN GOSUB 2000
  270 IF LAB=2 AND KB>0 AND KB<9 THEN GOSUB 2100
  299 GOTO 235
  300 GR : CALL -936
  305 GOSUB 11000: GOSUB 11100
  310 GOSUB 11200: GOSUB 11300
  315 GOSUB 11400: GOSUB 11500
  320 GOSUB 11600: GOSUB 11700
  325 GOSUB 11900: GOSUB 8200
  330 GOSUB 1400
  345 IF KB=16 THEN GOSUB 8200
  350 IF KB=22 THEN GOSUB 8210
  351 IF KB=20 THEN GOSUB 8220
  352 IF KB=6 THEN GOSUB 8230
  355 KB=KB-64
  360 IF LAB=1 AND KB>6 AND KB<19 THEN GOSUB 2000
  365 IF LAB=2 AND (KB=2 OR KB=3 OR (KB>8 AND KB<19)) THEN GOSUB 2100
  370 IF LAB=3 THEN GOSUB 2600
  375 IF LAB=4 THEN GOSUB 2700
  380 GOTO 330
  400 GR : CALL -936
  410 GOSUB 12000: GOSUB 12100: GOSUB 12200
  420 GOSUB 12900: GOSUB 8300: GOSUB 8310
  430 GOSUB 1400: GOSUB 3000: GOTO 430
  500 GR : CALL -936
  505 GOSUB 13000: GOSUB 13100
  510 GOSUB 13200: GOSUB 13300
  512 GOSUB 13400: GOSUB 13500
  515 GOSUB 13900: GOSUB 8400
  525 GOSUB 1400
  535 IF KB=16 THEN GOSUB 8400
  540 IF KB=22 THEN GOSUB 8410
  545 KB=KB-64
  550 IF LAB=1 AND KB>18 AND KB<25 THEN GOSUB 2000
  555 IF LAB=2 AND (KB=8 OR KB=19) THEN GOSUB 2100
  560 GOTO 525
  600 TEXT : CALL -969: GOSUB 2200
  610 GOSUB 8310: GOSUB 1400
  615 IF KB=16 THEN GOSUB 2200
  620 IF KB=22 THEN GOSUB 2500
  625 IF KB=20 THEN GOSUB 3400
  627 IF KB<27 THEN 610
  630 KB=KB-64
  635 IF LAB=1 THEN GOSUB 3100
  640 IF LAB=2 THEN GOSUB 3200
  645 IF LAB=3 THEN GOSUB 3300
  655 GOTO 610
  700 TEXT : CALL -936
  702 GOSUB 8700
  705 IF ACTP<LOSS1 THEN GOSUB 8500
  710 GOSUB 1400
  715 IF KB# ASC("$")-128 OR ACTP>LOSS1 THEN 702
  720 IF RND (100)>89 THEN 750
  725 GOSUB 8510: GOTO 710
  750 GOSUB 8520:ACTP=0: GOTO 710
  800 TEXT : CALL -936: GOSUB 8800
  810 GOSUB 3600: GOSUB 1400: GOTO 810
  900 TEXT : CALL -936: TAB 12: PRINT "SAVE / RESET STATE": VTAB 5
  905 PRINT "CATALOG (Y OR N)": POKE -16368,0
  910 KB= PEEK (-16384): IF KB<128 THEN 910: POKE -16368,0
  915 IF KB= ASC("Y") THEN PRINT "CATALOG"
  920 PRINT : PRINT "SAVE OR RESET (S OR R)": POKE -16368,0
  925 C= PEEK (-16384): IF C<128 THEN 925: POKE -16368,0: IF C# ASC("S") AND C# ASC("R") THEN RETURN : PRINT 
  930 INPUT "STATE NAME?",CMMD$: IF NOT LEN(CMMD$) THEN RETURN 
  940 IF C# ASC("S") THEN 950: PRINT "BSAVE ";CMMD$;",A3072,L1867,V0": RETURN 
  950 PRINT "BLOAD ";CMMD$;",A3072,V0": POKE 205,19: POKE 204,75: RETURN 
 1000 POKE SPK, PEEK (SPK): POKE SPK, PEEK (SPK)
 1002 OTMP=TEMP: IF NOT TEMP THEN 1010
 1004 TEMP=TEMP+(BU(2)<CNT)*CNT+(PI(3)=10 OR BU(4)=14)*CNT
 1005 TEMP=TEMP+ SGN (CNT-((PI(11)#10)*UC1+(PI(8)#10)*UC2))*CNT
 1006 TEMP=TEMP-(BU(4)<14 AND BU(6)<12 AND PI(3)#10)
 1010 CALL 2048
 1012 IF SCNT=1440 THEN GOSUB 1100
 1014 IF NOT DCNT THEN GOSUB 1900
 1030 V=1: IF (BO(3)>11 AND VA(V)=1) OR (BO(3)<2 AND VA(V)=12) THEN GOSUB 2110
 1031 IF BU(2) OR UC1 OR SCNT MOD 10 THEN 1033
 1032 FOR U=1 TO 3: IF PU(U)=1 THEN GOSUB 2010: NEXT U: GOSUB 20500: GOSUB 20200: GOSUB 20400
 1033 IF NOT BO(7) OR UC8 THEN 1040
 1034 FOR U=22 TO 24: IF UC8 THEN 1040: IF PU(U)=1 THEN GOSUB 2010: NEXT U
 1040 BU(1)=BO(1)+(VA(1)=12 AND TEMP>TMP1)-(TEMP<TMP3 AND BO(1)>9)*10+LEAK
 1041 BU(7)=BO(7)+(PI(9)#10 AND (LEAK OR (VA(1)=12 AND BO(3)>23)))+(BO(1)>9 AND TEMP<TMP3)-(PI(12)#10 AND BO(7))
 1042 IF (BO(1)#BU(1) AND BU(1)<11) OR (BO(7)#BU(7) AND BU(7)<11) THEN GOSUB 10600
 1043 IF VA(V)#12 THEN 1044:BU(2)=BO(2)-( NOT BO(3) AND BO(2)>1): GOTO 1047
 1044 IF PI(9)#10 THEN 1045:BU(2)=BO(2)-(TEMP>TMP1 AND NOT BO(3) AND BO(2)): GOTO 1047
 1045 IF TEMP<TMP3 THEN 1046:BU(2)=BO(2)+(BO(2)>11 AND BO(3)=12)+(BO(2)<12): GOTO 1047
 1046 BU(2)=BO(2)+(BO(2)<12)-(BO(2)>12)
 1047 BU(2)=BU(2)-(LEAK AND PI(10)=10 AND BO(2))
 1048 BU(5)=BO(5)+( NOT BO(2) AND TEMP>TMP3)-(BO(5) AND BO(2))
 1049 IF (BO(2)=BU(2) OR BU(2)>12) AND (BO(5)=BU(5) OR BU(5)>12) THEN 1050: GOSUB 10700: GOSUB 12200
 1050 IF VA(V)#12 THEN 1051:BU(3)=BO(3)-(BO(2)>1 AND BO(3))+(PI(9)#10 AND BO(2)<2 AND BO(3)<24): GOTO 1055
 1051 IF PI(9)#10 THEN 1052:BU(3)=BO(3)-(TEMP>TMP1 AND BO(3)): GOTO 1055
 1052 IF TEMP<TMP3 THEN 1053:BU(3)=BO(3)+(BO(3)<12 AND BO(2)=12 AND TEMP>OTMP): GOTO 1055
 1053 BU(3)=BO(3)+(BO(2)=12 AND BO(3)<6)-(BO(2)=12 AND BO(3)>6)
 1055 IF BO(3)#BU(3) THEN GOSUB 10200
 1060 BU(4)=BO(4)+(PI(2)=10 AND TEMP>TMP1 AND BO(4)<14)-(PI(2)#10 AND BO(4))
 1061 IF BO(4)#BU(4) THEN GOSUB 10300
 1062 V=2:P=1: IF BO(4)<14 OR PI(1)=10 THEN 1063:PI(P)=10: GOTO 1064
 1063 IF BO(4)>13 OR PI(1)#10 OR VA(2)#12 THEN 1070:PI(P)=14
 1064 GOSUB 16100: GOSUB 14100: GOSUB 16000: GOSUB 14000: GOSUB 1200
 1070 BU(6)=BO(6)+((PI(17)=10 OR PI(1)=10) AND TEMP>TMP1 AND BO(6)<10)-(PI(17)#10 AND PI(1)#10 AND BO(6))
 1071 IF BO(6)#BU(6) THEN GOSUB 11200
 1072 IF BO(6)=10 AND PI(18)#10 THEN GOSUB 5241
 1073 IF BO(6)<10 AND PI(18)=10 AND UC4 THEN GOSUB 5228
 1080 BU(8)=BO(8)+(UC8 AND VA(8)=12 AND BO(7) AND BO(8)<50)
 1081 BU(9)=BO(9)+(UC7 AND VA(19)=12 AND BO(10) AND BO(9)<75)
 1082 BU(10)=BO(10)+(UC8 AND VA(8)=12 AND BO(7) AND BO(8)=50)-(UC7 AND VA(19)=12 AND BO(10) AND BO(9)<75)
 1083 BU(11)=BO(11)+(BO(10)>0)+BO(10)/10-( NOT BO(10) AND BO(11))-(BO(11)>1)
 1085 IF DYN=3 AND BO(10)#BU(10) THEN GOSUB 5451
 1086 IF (DYN=0 OR DYN=3) AND BO(7)#BU(7) THEN GOSUB 5526
 1090 IF DYN#3 THEN RETURN 
 1091 IF BO(8)/5#BU(8)/5 THEN GOSUB 13200
 1092 IF BO(9)/5#BU(9)/5 THEN GOSUB 13300
 1093 IF BO(10)#BU(10) AND BU(10)<10 THEN GOSUB 13400
 1094 IF BO(11)/10#BU(11)/10 AND BU(11)<151 THEN GOSUB 13500
 1099 RETURN 
 1100 SCNT=0:DAY=DAY+1
 1110 COST=COST+ RND (10)+1:MAIN=0
 1115 FOR C=1 TO 4: CALL BELL: CALL BELL: CALL BELL: FOR I=1 TO 20: NEXT I,C
 1120 IF DYN=5 THEN GOSUB 8700: RETURN 
 1200 CALL 2360: CALL 2102
 1210 IF DYN=5 THEN GOSUB 8700: RETURN 
 1300 FOR V=1 TO 19
 1305 IF VC(V)>0 THEN 1390
 1310 IF NOT VA(V) THEN 1350
 1320 VC(V)=32767: CALL BELL: GOTO 1380
 1350 VC(V)= RND (VF1)+VF0: CALL BELL: CALL BELL:VA(V)=1
 1380 GOSUB 4000+(V-1)*25
 1385 IF DYN=4 AND LAB=2 THEN GOSUB 2550
 1390 NEXT V: RETURN 
 1400 IF NOT CMMD THEN 1440
 1401 KB= ASC(CMMD$(CHAR,CHAR))
 1402 IF NOT CCNT THEN 1420
 1410 CCNT=CCNT-1:CHAR=CHAR+ NOT CCNT
 1413 IF KB= ASC("<") THEN KB=8+128
 1414 IF KB= ASC(">") THEN KB=21+128
 1415 IF KB= ASC(":") THEN KB=13+128
 1416 CMMD=CHAR<= LEN(CMMD$)
 1417 GOTO 1491
 1420 CHAR=CHAR+1: IF KB# ASC("#") THEN 1413
 1424 KB= ASC(CMMD$(CHAR,CHAR))
 1425 IF KB< ASC("0") OR KB> ASC("9") THEN 1410
 1426 CCNT=CCNT*10+(KB- ASC("0")):CHAR=CHAR+1: GOTO 1424
 1440 KB= PEEK (-16384): IF KB>127 THEN 1490
 1450 IF SYM THEN GOSUB 1000
 1451 IF FFLG THEN GOSUB 1500
 1452 IF NOT DYN OR DYN=2 THEN GOSUB 1600
 1453 IF VFLG THEN GOSUB 1300
 1454 IF UFLG THEN GOSUB 1800
 1455 IF TFLG THEN GOSUB 3500
 1456 IF EFLG THEN GOSUB 20300
 1457 IF DYN=-1 OR DYN>3 THEN GOSUB 3700
 1480 IF ACTP<LOSS2 THEN GOSUB 20000
 1481 IF BU(1)>CP THEN GOSUB 20100
 1482 IF BU(2)>LK0 AND NOT LEAK THEN GOSUB 20600
 1483 IF BU(11)>RAD1 THEN GOSUB 20800
 1484 IF NOT GC(11) THEN GOSUB 21100
 1485 IF TEMP>TMPMD THEN GOSUB 22000
 1486 FRDMG=FRDMG OR ( NOT BU(2) AND BU(5))
 1487 IF BU(1)>RD1 OR BU(5)>RD5 THEN GOSUB 20900
 1489 GOTO 1400
 1490 POKE -16368,0
 1491 KB=KB-128
 1492 IF KB=27 THEN SYM= NOT SYM
 1493 IF DYN<0 THEN RETURN 
 1494 IF (KB>47 AND KB<58) OR KB=13 OR DYN=10 THEN POP 
 1499 RETURN 
 1500 FOR F=1 TO 3
 1502 IF FI(F)=10 THEN 1550
 1504 IF SC(F)>0 THEN 1599
 1506 SC(F)= RND (SR1)+SR0
 1508 SL(F)=SL(F)+1
 1510 SP(F)= RND (10+SL(F))+SL(F)
 1512 IF SL(F)<=10 THEN 1522
 1514 SC(F)=0
 1516 SP(F)= RND (26)+10
 1518 CALL BELL
 1520 C=10: GOSUB 2720: GOTO 1599
 1522 GOSUB 11300: GOTO 1599
 1550 IF NOT SL(F) OR VA(F+15)#12 THEN 1599
 1555 C=0
 1560 IF UC6 THEN C= RND (8*UC6)+UC6
 1564 IF VA(F+12)=12 THEN C=C+ RND (10)+2
 1565 IF C<SP(F) THEN 1599
 1570 SL(F)=0
 1575 SC(F)= RND (SR1)+SR0
 1576 CALL BELL: CALL BELL
 1580 GOSUB 11300
 1599 NEXT F: RETURN 
 1600 R= RND (18)+1: IF NOT CR(R) THEN RETURN 
 1605 C=CRC(R): IF C=1 THEN CRC(R)=9: IF C=9 THEN CRC(R)=1
 1635 COLOR=CRC(R): IF NOT DYN THEN PLOT CX(R),CY(R)
 1650 IF DYN=2 THEN GOSUB 3050: RETURN 
 1800 FOR U=1 TO 24
 1805 IF UC(U)>0 THEN 1890
 1810 IF NOT PU(U) THEN 1850
 1815 UC(U)=32767: CALL BELL: GOTO 1880
 1850 UC(U)= RND (UF1)+UF0: CALL BELL: CALL BELL
 1880 PU(U)=1: GOSUB 15000: GOSUB 15100: GOSUB 15300
 1883 GOSUB 5000+(U-1)*25
 1885 IF DYN=4 AND LAB=1 THEN GOSUB 2250
 1890 NEXT U: RETURN 
 1900 DCNT=DC0+ RND (DC1)*( RND (3)-1)
 1910 FOR C=1 TO 2: CALL BELL: CALL BELL: CALL BELL: FOR I=1 TO 20: NEXT I,C
 1930 C=DM0+ RND (DM1):DMND=DMND+(SCNT<720)*C-(SCNT>720)*C/2
 1935 IF DMND>1000 THEN DMND=1000
 1940 IF DMND<100 THEN DMND=100
 1950 GOSUB 1200: RETURN 
 2000 U=KB
 2010 IF NOT PU(U) OR UC(U)>UF1+UF0 THEN RETURN 
 2015 C=1: IF PU(U)=1 THEN C=12
 2025 PU(U)=C: GOSUB 15000: GOSUB 15100: GOSUB 15300
 2030 UC(U)=UC(U)- RND (UA1)-UA0
 2040 GOSUB 5000+(U-1)*25: RETURN 
 2100 V=KB
 2110 IF NOT VA(V) OR VC(V)>VF1+VF0 THEN RETURN 
 2115 C=1: IF VA(V)=1 THEN C=12
 2125 VA(V)=C
 2130 VC(V)=VC(V)- RND (VA1)-VA0
 2135 GOSUB 4000+(V-1)*25: RETURN 
 2200 GOSUB 8600
 2210 LAB=1: FOR U=1 TO 24: GOSUB 2250: NEXT U: RETURN 
 2250 C1=(U>12)*20
 2252 VTAB 5+(U-1) MOD 12: TAB 1+C1
 2254 POKE 33,20+C1: CALL -868: POKE 33,40
 2256 PRINT LET$(U,U);"  ";
 2258 IF UC(U)<UF0+UF1 THEN 2262
 2260 POKE 50,127: PRINT "FAILED";: POKE 50,255: RETURN 
 2262 IF PU(U)=1 THEN 2266: IF PU(U)=12 THEN 2268
 2264 POKE 50,63: PRINT "REPAIR";: POKE 50,255:C=SCNT+UC(U): GOTO 2270
 2266 PRINT "OFF";: RETURN 
 2268 PRINT "ON";:C=SCNT+UC(U)/CNT
 2270 TAB 12+C1: GOSUB 3710: RETURN 
 2500 GOSUB 8610
 2510 LAB=2: FOR V=1 TO 19: GOSUB 2550: NEXT V: RETURN 
 2550 C1=(V>10)*20
 2552 VTAB 5+(V-1) MOD 10: TAB 1+C1
 2554 POKE 33,20+C1: CALL -868: POKE 33,40
 2556 PRINT LET$(V,V);"  ";
 2558 IF VC(V)<VF1+VF0 THEN 2562
 2560 POKE 50,127: PRINT "FAILED";: POKE 50,255: RETURN 
 2562 IF VA(V)=1 THEN 2566: IF VA(V)=12 THEN 2568
 2564 POKE 50,63: PRINT "REPAIR";: POKE 50,255:C=SCNT+VC(V): GOTO 2570
 2566 PRINT "SHUT";: RETURN 
 2568 PRINT "OPEN";:C=SCNT+VC(V)/CNT
 2570 TAB 12+C1: GOSUB 3710: RETURN 
 2600 T=KB: IF T<1 OR T>4 THEN RETURN 
 2610 IF NOT TU(T) OR TC(T)>TF1+TF0 THEN RETURN 
 2615 C=10: IF TU(T)=10 THEN C=13
 2625 TU(T)=C
 2627 TCNT=(TU(1)=13)+(TU(2)=13)+(TU(3)=13)+(TU(4)=13)
 2630 TC(T)=TC(T)- RND (TA1)-TA0
 2635 GOSUB 11100: GOSUB 1200: RETURN 
 2700 F=KB: IF F<1 OR F>3 THEN RETURN 
 2710 C=8: IF SL(F)>10 OR FI(F)=8 THEN C=10
 2720 FI(F)=C: GOSUB 11300
 2727 FC=(FI(1)=8)+(FI(2)=8)+(FI(3)=8)
 2730 IF C=10 THEN 2750
 2731 P=16:PI(P)=PI(18): GOSUB 16100
 2732 P=13: IF PI(P)#10 THEN RETURN 
 2733 PI(P)=PI(16): GOSUB 16100
 2734 P=2:V=3: IF VA(V)#12 THEN RETURN 
 2735 PI(P)=PI(13): GOSUB 16100
 2736 GOSUB 14100
 2750 IF FC THEN RETURN 
 2755 P=16:PI(P)=10: GOSUB 16100
 2760 IF PI(14)#10 OR PI(15)#10 THEN RETURN 
 2765 P=13:PI(P)=10: GOSUB 16100
 2770 V=3:P=2:PI(P)=10: GOSUB 16100: GOSUB 14100
 2775 GOSUB 16000: GOSUB 14000: RETURN 
 3000 R=RPOS
 3004 IF KB=43 OR KB=59 THEN 3030
 3005 IF KB=45 OR KB=61 THEN 3040
 3009 IF KB#21 AND KB#8 THEN RETURN 
 3010 VTAB 21: TAB RPOS*2+2
 3011 PRINT " ";
 3012 RPOS=RPOS+(RPOS<18 AND KB=21)-(RPOS>1 AND KB=8)
 3013 TAB RPOS*2+2
 3014 POKE 50,127: PRINT " ": POKE 50,255
 3015 RETURN 
 3030 TMP0=TMP0+(CR(R)<33)
 3031 R1=(R-1)/9+1
 3032 CCR(R1)=CCR(R1)+(CR(R)<33)
 3033 CR(R)=CR(R)+(CR(R)<33)
 3034 IF CRC(R)=12 THEN CRC(R)=9
 3035 IF CR(R)>14 THEN CRC(R)=1
 3038 GOSUB 1200: GOTO 3050
 3040 TMP0=TMP0-(CR(R)>0)
 3041 R1=(R-1)/9+1
 3042 CCR(R1)=CCR(R1)-(CR(R)>0)
 3043 CR(R)=CR(R)-(CR(R)>0)
 3044 IF CR(R)<15 THEN CRC(R)=9
 3045 IF CR(R)<4 THEN CRC(R)=12
 3050 COLOR=CRC(R):Y2=37-CR(R):X=R*2+1
 3065 IF Y2<37 THEN VLIN Y2+1,37 AT X
 3070 COLOR=8: VLIN 0,Y2 AT X
 3085 VTAB 22: TAB 1: PRINT "TEMP=";TEMP;"  ";: TAB 20: PRINT "CNT=";CNT: RETURN 
 3100 IF KB<1 OR KB>24 THEN 3145
 3105 U=KB
 3110 IF NOT PU(U) THEN 3140
 3115 PU(U)=0
 3130 UC(U)= RND (UR1)+UR0
 3132 MAIN=MAIN+ RND (UM1)+UM0
 3135 GOSUB 5000+(U-1)*25
 3140 GOSUB 2250: RETURN 
 3145 GOSUB 2210: RETURN 
 3200 IF KB<1 OR KB>19 THEN 3245
 3205 V=KB
 3210 IF NOT VA(V) THEN 3240
 3215 VA(V)=0
 3230 VC(V)= RND (VR1)+VR0
 3232 MAIN=MAIN+VM0+ RND (VM1)
 3235 GOSUB 4000+(V-1)*25
 3240 GOSUB 2550: RETURN 
 3245 GOSUB 2510: RETURN 
 3300 IF KB<1 OR KB>4 THEN 3335
 3305 T=KB
 3310 IF NOT TU(T) THEN 3325
 3315 TU(T)=0
 3320 TC(T)= RND (TR1)+TR0
 3322 MAIN=MAIN+TM0+ RND (TM1)
 3324 TCNT=(TU(1)=13)+(TU(2)=13)+(TU(3)=13)+(TU(4)=13)
 3325 GOSUB 1200: GOSUB 3450: RETURN 
 3335 GOSUB 3410: RETURN 
 3400 GOSUB 8620
 3410 LAB=3: FOR T=1 TO 4: GOSUB 3450: NEXT T: RETURN 
 3450 VTAB 4+T: TAB 1: CALL -868
 3455 PRINT LET$(T,T);"  ";
 3460 IF TC(T)<TF0+TF1 THEN 3470
 3465 POKE 50,127: PRINT "FAILED";: POKE 50,255: RETURN 
 3470 IF TU(T)=10 THEN 3480: IF TU(T)=13 THEN 3485
 3475 POKE 50,63: PRINT "REPAIR";: POKE 50,255:C=SCNT+TC(T): GOTO 3490
 3480 PRINT "OFF LINE";: RETURN 
 3485 PRINT "ON LINE";:C=SCNT+TC(T)/CNT
 3490 TAB 14: GOSUB 3710: RETURN 
 3500 FOR T=1 TO 4
 3505 IF TC(T)>0 THEN 3590
 3510 IF NOT TU(T) THEN 3550
 3520 TC(T)=32767: CALL BELL: GOTO 3560
 3550 TC(T)=TF0+ RND (TF1)
 3555 CALL BELL: CALL BELL
 3560 TU(T)=10: IF DYN=4 AND LAB=3 THEN GOSUB 3450
 3590 NEXT T
 3591 TCNT=(TU(1)=13)+(TU(2)=13)+(TU(3)=13)+(TU(4)=13)
 3592 GOSUB 11100: GOSUB 1200: RETURN 
 3600 IF GMAIN THEN GOSUB 21200
 3604 FOR C1=1 TO 10
 3605 VTAB C1*2+1: TAB 15: CALL -868
 3608 IF NOT GC(C1) AND NOT RND (2) THEN 3640: GOTO 3610+C1
 3611 PRINT TEMP;" DEG": GOTO 3650
 3612 PRINT TMP0;" DEG": GOTO 3650
 3613 PRINT BU(2)*100+1200;" PSI": GOTO 3650
 3614 PRINT CNT: GOTO 3650
 3615 PRINT BU(1);: IF BU(1) THEN PRINT "00";: PRINT " PSI": GOTO 3650
 3616 PRINT BU(7);: IF BU(7) THEN PRINT ",000";: PRINT " GAL": GOTO 3650
 3617 PRINT BU(10);: IF BU(10) THEN PRINT ",000";: PRINT " GAL": GOTO 3650
 3618 C=BU(11) MOD 100: PRINT BU(11)/100;".";: IF C<10 THEN PRINT "0";: PRINT C;" MREMS/HR": GOTO 3650
 3619 C=FF0-FCNT: IF C>=0 THEN GOSUB 3720: GOTO 3650
 3620 PRINT BU(3);: IF BU(3) THEN PRINT ",000";: PRINT " GAL": GOTO 3650
 3640 PRINT RND (100)
 3650 NEXT C1
 3655 VTAB 23: CALL -868
 3660 POKE 50,127: FOR I=1 TO 11
 3662 VTAB I*2+1: TAB 30: GOTO 3670+I
 3671 IF CP=32767 THEN PRINT "SEALED": GOTO 3690
 3672 IF TEMP>TMP3 THEN PRINT "TEMP": GOTO 3690
 3673 IF FRDMG THEN PRINT "FR DAMAGE": GOTO 3690
 3674 IF NOT TMP0 THEN PRINT "SCRAM": GOTO 3690
 3675 IF UC1 THEN PRINT "ECCS";: TAB 35: IF UC3 THEN PRINT "ESCS": GOTO 3690
 3676 IF BU(11) THEN PRINT "RADLEAK": GOTO 3690
 3677 IF NOT FC THEN PRINT "FLTR";: TAB 35: IF AIR THEN PRINT "AIR": GOTO 3690
 3678 IF BU(6) THEN PRINT "CNDSER": GOTO 3690
 3679 IF BU(4) THEN PRINT "STMER": GOTO 3690
 3680 IF LEAK THEN PRINT "PCSLEAK": GOTO 3690
 3681 IF EOUT AND EOUT<DMND THEN PRINT "BROWNOUT": IF NOT EOUT THEN PRINT "BLACKOUT"
 3690 NEXT I: POKE 50,255: RETURN 
 3700 VTAB 24: TAB 17: POKE 50,63
 3705 C=SCNT
 3710 K=DAY: IF C<1440 THEN 3715:K=K+1:C=C-1440
 3715 PRINT K;"/";
 3720 I=C/60:J=C MOD 60
 3725 IF I<10 THEN PRINT "0";: PRINT I;":";
 3730 IF J<10 THEN PRINT "0";: PRINT J;
 3735 POKE 50,255: RETURN 
 4000 GOTO 4975
 4025 P=1:PI(P)=10: IF VA(V)#12 THEN 4040
 4035 PI(P)=14:CP=CP0
 4040 GOSUB 1200: GOTO 4950
 4050 P=2:PI(P)=10: IF VA(V)#12 THEN 4950
 4060 CP=CP0:PI(P)=PI(13): GOTO 4950
 4075 IF VA(V)#12 THEN 4090
 4077 P=11:PI(P)=PI(10): GOSUB 16000
 4079 IF PI(P)=10 THEN GOTO 4975
 4081 P=9:PI(P)=PI(11): GOSUB 16000: GOTO 4975
 4090 P=11:PI(P)=10: GOSUB 16000
 4091 IF PI(8)#10 THEN 4975
 4093 P=9:PI(P)=10: GOSUB 16000: GOTO 4975
 4100 P=5
 4101 IF VA(V)#12 THEN 4112
 4102 PI(P)=PI(4): GOSUB 16000
 4103 IF PI(P)=10 THEN 4975
 4104 P=8:PI(P)=PI(4): GOSUB 16000
 4105 P=9:PI(P)=PI(8): GOSUB 16000: GOTO 4975
 4112 PI(P)=10: GOSUB 16000
 4113 IF PI(8)=10 OR PI(5)#10 OR PI(6)#10 OR PI(7)#10 THEN 4975
 4114 P=8:PI(P)=10: GOSUB 16000
 4115 IF PI(11)#10 THEN 4975
 4116 P=9:PI(P)=10: GOSUB 16000: GOTO 4975
 4125 P=6: GOTO 4101
 4150 P=7: GOTO 4101
 4175 P=12
 4177 IF VA(V)=1 OR NOT UC8 OR NOT BU(7) THEN 4190
 4179 CP=CP0
 4181 IF PI(P)#10 THEN 4975
 4183 PI(P)=2: GOTO 4950
 4190 IF PI(P)=10 THEN 4975
 4192 PI(P)=10: GOTO 4950
 4200 P=14
 4201 IF VA(V)#12 THEN 4212
 4202 IF NOT UC3 THEN 4975
 4203 PI(P)=2: GOSUB 16100: IF PI(13)#10 THEN 4975
 4204 P=13:PI(P)=7: GOSUB 16100
 4205 IF VA(3)#12 THEN 4975: GOSUB 14100
 4207 V=3:P=2:PI(P)=7: GOTO 4950
 4212 PI(P)=10: GOSUB 16100
 4213 IF PI(14)#10 OR PI(15)#10 OR PI(13)=PI(16) THEN 4975
 4214 P=13:PI(P)=PI(16): GOSUB 16100
 4215 IF VA(3)#12 OR PI(2)=PI(13) THEN 4975: GOSUB 14100
 4217 V=3:P=2:PI(2)=PI(13): GOTO 4950
 4225 P=15: GOTO 4201
 4250 P=21
 4255 PI(P)=10
 4260 IF VA(V)#12 THEN 4270
 4265 IF UC5 THEN PI(P)=6
 4270 GOSUB 16100: GOSUB 14100
 4271 P=17:PI(P)=10
 4272 IF PI(21)#10 OR PI(22)#10 THEN PI(P)=6
 4273 GOSUB 16100: RETURN 
 4275 P=22: GOTO 4255
 4300 IF VA(V)#12 THEN 4310
 4302 IF VA(16)=12 AND PI(19)#10 AND FI(1)=10 THEN 4310
 4304 VA(V)=1
 4306 CALL BELL: CALL BELL: CALL BELL: RETURN 
 4310 GOSUB 11600: GOTO 4975
 4325 IF VA(V)#12 THEN 4310
 4330 IF VA(17)=12 AND PI(19)#10 AND FI(2)=10 THEN 4310
 4335 GOTO 4304
 4350 IF VA(V)#12 THEN 4310
 4355 IF VA(18)=12 AND PI(19)#10 AND FI(3)=10 THEN 4310
 4360 GOTO 4304
 4375 IF VA(V)=12 OR VA(13)#12 THEN 4975
 4380 VA(V)=12
 4385 CALL BELL: CALL BELL: CALL BELL: RETURN 
 4400 IF VA(V)=12 OR VA(14)#12 THEN 4975: GOTO 4380
 4425 IF VA(V)=12 OR VA(15)#12 THEN 4975: GOTO 4380
 4450 P=23
 4452 IF VA(V)=1 OR NOT UC7 OR NOT BU(10) THEN 4460
 4454 IF PI(P)#10 THEN 4975
 4456 PI(P)=2: GOTO 4950
 4460 IF PI(P)=10 THEN 4975
 4462 PI(P)=10: GOTO 4950
 4950 GOSUB 16000
 4955 GOSUB 16100
 4965 GOSUB 16300
 4975 GOSUB 14000
 4980 GOSUB 14100
 4990 GOSUB 14300
 4999 RETURN 
 5000 P=10:V=4
 5001 UC1=(PU(1)=12)+(PU(2)=12)+(PU(3)=12): IF NOT UC1 THEN 5012
 5002 IF PI(P)#10 THEN RETURN 
 5003 PI(P)=2: GOSUB 16000
 5004 P=11: IF VA(V)#12 OR PI(P)#10 THEN RETURN 
 5006 PI(P)=PI(10): GOSUB 16000: GOSUB 14000
 5007 P=9:PI(P)=PI(11): GOSUB 16000: RETURN 
 5012 PI(P)=10: GOSUB 16000
 5013 P=11: IF PI(P)=10 THEN 5015:PI(P)=10: GOSUB 16000: GOSUB 14000
 5015 IF PI(8)#10 THEN RETURN 
 5016 P=9:PI(P)=10: GOSUB 16000: RETURN 
 5025 GOTO 5000
 5050 GOTO 5000
 5075 UC2=(PU(4)=12)+(PU(5)=12)+(PU(6)=12): IF NOT UC2 THEN 5090
 5076 P=4: IF PI(P)#10 THEN RETURN 
 5077 PI(P)=2: GOSUB 16000
 5078 P=5:V=5: IF VA(V)#12 THEN 5080
 5079 PI(P)=PI(4): GOSUB 16000: GOSUB 14000
 5080 P=6:V=6: IF VA(V)#12 THEN 5082
 5081 PI(P)=PI(4): GOSUB 16000: GOSUB 14000
 5082 P=7:V=7: IF VA(V)#12 THEN 5084
 5083 PI(P)=PI(4): GOSUB 16000: GOSUB 14000
 5084 IF VA(5)#12 AND VA(6)#12 AND VA(7)#12 THEN RETURN 
 5085 P=8:PI(P)=PI(4): GOSUB 16000
 5086 P=9:PI(P)=PI(4): GOSUB 16000: RETURN 
 5090 P=4:PI(P)=10: GOSUB 16000
 5091 FOR V=5 TO 7
 5092 P=VP(V): IF PI(P)=10 THEN 5093:PI(P)=10: GOSUB 16000: GOSUB 14000
 5093 NEXT V
 5094 P=8:PI(P)=10: GOSUB 16000
 5095 IF PI(11)#10 THEN RETURN 
 5096 P=9:PI(P)=10: GOSUB 16000: RETURN 
 5100 GOTO 5075
 5125 GOTO 5075
 5150 UC3=(PU(7)=12)+(PU(8)=12)+(PU(9)=12): IF PU(U)#12 THEN 5165
 5151 P=20:PI(P)=2: GOSUB 16100
 5152 IF VA(9)#12 AND VA(10)#12 THEN RETURN 
 5153 V=9:P=14: IF VA(V)#12 OR PI(P)#10 THEN 5155
 5154 PI(P)=PI(20): GOSUB 16100: GOSUB 14100
 5155 V=10:P=15: IF VA(V)#12 OR PI(P)#10 THEN 5157
 5156 PI(P)=PI(20): GOSUB 16100: GOSUB 14100
 5157 P=13: IF PI(P)#10 THEN RETURN 
 5158 PI(P)=7: GOSUB 16100
 5159 V=3:P=2: IF VA(V)#12 THEN RETURN 
 5160 PI(P)=7: GOSUB 16100: GOSUB 14100
 5161 GOSUB 16000: GOSUB 14000: RETURN 
 5165 IF UC3 THEN RETURN 
 5166 P=20:PI(P)=10: GOSUB 16100
 5167 V=9:P=14: IF PI(P)=10 THEN 5168:PI(P)=10: GOSUB 16100: GOSUB 14100
 5168 V=10:P=15: IF PI(P)=10 THEN 5170:PI(P)=10: GOSUB 16100: GOSUB 14100
 5170 P=13:PI(P)=PI(16): GOSUB 16100
 5171 V=3:P=2: IF VA(V)#12 OR PI(P)=PI(13) THEN RETURN 
 5172 PI(P)=PI(13): GOSUB 16100: GOSUB 14100
 5173 GOSUB 16000: GOSUB 14000: RETURN 
 5175 GOTO 5150
 5200 GOTO 5150
 5225 UC4=(PU(10)=12)+(PU(11)=12)+(PU(12)=12)
 5226 IF BU(6)=10 AND PI(18)=10 THEN RETURN : IF BU(6)=10 THEN 5241
 5227 IF PU(U)#12 THEN 5240
 5228 P=18:PI(P)=7: GOSUB 16100
 5229 IF NOT FC THEN RETURN 
 5230 P=16:PI(P)=PI(18): GOSUB 16100
 5231 P=13:PI(P)=PI(16): GOSUB 16100
 5232 V=3:P=2: IF VA(V)#12 OR PI(P)#10 THEN RETURN 
 5233 PI(P)=7: GOSUB 16100: GOSUB 14100
 5234 GOSUB 16000: GOSUB 14000: RETURN 
 5240 IF UC4 THEN RETURN 
 5241 P=18:PI(P)=10: GOSUB 16100
 5242 P=16:PI(P)=10: GOSUB 16100
 5243 IF PI(14)#10 OR PI(15)#10 THEN RETURN 
 5244 P=13: IF PI(P)=10 THEN RETURN :PI(P)=10: GOSUB 16100
 5245 V=3:P=2:PI(P)=10
 5246 GOSUB 16100: GOSUB 14100: GOSUB 16000: GOSUB 14000: RETURN 
 5250 GOTO 5225
 5275 GOTO 5225
 5300 UC5=(PU(13)=12)+(PU(14)=12)+(PU(15)=12)
 5301 IF PU(U)#12 THEN 5315
 5302 V=11:P=21: IF VA(V)#12 OR PI(P)#10 THEN 5304
 5303 PI(P)=6: GOSUB 16100: GOSUB 14100
 5304 V=12:P=22: IF VA(V)#12 OR PI(P)#10 THEN 5306
 5305 PI(P)=6: GOSUB 16100: GOSUB 14100
 5306 IF VA(11)#12 AND VA(12)#12 THEN RETURN 
 5307 P=17:PI(P)=6: GOSUB 16100: RETURN 
 5315 IF UC5 THEN RETURN 
 5316 V=11:P=21: IF PI(P)=10 THEN 5318
 5317 PI(P)=10: GOSUB 16100: GOSUB 14100
 5318 V=12:P=22: IF PI(P)=10 THEN 5320
 5319 PI(P)=10: GOSUB 16100: GOSUB 14100
 5320 P=17:PI(P)=10: GOSUB 16100: RETURN 
 5325 GOTO 5300
 5350 GOTO 5300
 5375 UC6=(PU(16)=12)+(PU(17)=12)+(PU(18)=12)
 5380 P=19:PI(P)=FCOL(UC6+1)
 5381 GOSUB 16100: RETURN 
 5400 GOTO 5375
 5425 GOTO 5375
 5450 UC7=(PU(19)=12)+(PU(20)=12)+(PU(21)=12)
 5451 V=19:P=23
 5452 IF NOT UC7 OR VA(V)#12 OR NOT BU(10) THEN GOTO 5460
 5453 IF PI(P)#10 THEN RETURN 
 5454 PI(P)=2: GOTO 5462
 5460 IF PI(P)=10 THEN RETURN 
 5461 PI(P)=10
 5462 GOSUB 16300: GOSUB 14300: RETURN 
 5475 GOTO 5450
 5500 GOTO 5450
 5525 UC8=(PU(22)=12)+(PU(23)=12)+(PU(24)=12)
 5526 V=8:P=12
 5527 IF NOT UC8 OR VA(V)#12 OR NOT BU(7) THEN GOTO 5535
 5528 IF PI(P)#10 THEN RETURN 
 5529 PI(P)=2: GOTO 5542
 5535 IF PI(P)=10 THEN RETURN 
 5540 PI(P)=10
 5542 GOSUB 16000: GOSUB 14000: GOSUB 16300: GOSUB 14300: RETURN 
 5550 GOTO 5525
 5575 GOTO 5525
 8000 VTAB 3: TAB 12
 8002 PRINT "THREE MILE ISLAND": VTAB 5: TAB 16: PRINT "MAIN MENU": VTAB 7: TAB 5
 8004 PRINT "0  CONTAINMENT": PRINT : TAB 5
 8006 PRINT "1  TURBINE, FILTER, CONDENSER": PRINT : TAB 5
 8008 PRINT "2  REACTOR CORE": PRINT : TAB 5
 8010 PRINT "3  PUMP HOUSE": PRINT : TAB 5
 8012 PRINT "4  MAINTENANCE SCHEDULE": PRINT : TAB 5
 8014 PRINT "5  COST ANALYSIS": PRINT : TAB 5
 8016 PRINT "6  OPERATIONAL STATUS": PRINT : TAB 5
 8018 PRINT "7  SAVE / RESET STATE"
 8099 RETURN 
 8100 CALL -936
 8101 VTAB 22: TAB 25
 8102 PRINT "ABC";
 8103 TAB 32: PRINT "DEF"
 8104 VTAB 24: TAB 11
 8105 PRINT "CONTAINMENT - PUMPS";
 8109 LAB=1: RETURN 
 8110 CALL -936
 8111 VTAB 21: TAB 24: PRINT "A";: TAB 38: PRINT "B"
 8112 VTAB 22: TAB 3: PRINT "H";
 8113 TAB 10: PRINT "G F E D";
 8114 TAB 38: PRINT "C"
 8115 VTAB 24: TAB 11
 8116 PRINT "CONTAINMENT - VALVES";
 8119 LAB=2: RETURN 
 8200 CALL -936:LAB=1: VTAB 22
 8202 TAB 9: PRINT "GHI";
 8203 TAB 21: PRINT "JKL";
 8204 TAB 31: PRINT "MNO";
 8205 TAB 35: PRINT "PQR";
 8206 VTAB 24: TAB 4
 8207 PRINT "TURBINE, FILTER, CONDENSER - PUMPS";
 8209 RETURN 
 8210 CALL -936:LAB=2
 8211 VTAB 21: TAB 2: PRINT "B";
 8212 TAB 8: PRINT "M I";
 8213 TAB 14: PRINT "N";: TAB 20: PRINT "O";: TAB 29: PRINT "K"
 8214 VTAB 22: TAB 2: PRINT "C";
 8215 TAB 7: PRINT "P  J  Q";
 8216 TAB 19: PRINT "R";: TAB 28: PRINT "L"
 8218 VTAB 24: TAB 3
 8219 PRINT "TURBINE, FILTER, CONDENSER - VALVES";: RETURN 
 8220 CALL -936:LAB=3
 8221 VTAB 22: TAB 12
 8222 PRINT "A   B   C   D"
 8223 VTAB 24: TAB 3
 8224 PRINT "TURBINE, FILTER, CONDENSER - TURBINES";: RETURN 
 8230 CALL -936:LAB=4: VTAB 22
 8232 TAB 7: PRINT "A";
 8233 TAB 13: PRINT "B";
 8234 TAB 19: PRINT "C"
 8235 VTAB 24: TAB 3
 8236 PRINT "TURBINE, FILTER, CONDENSER - FILTERS";
 8237 RETURN 
 8300 CALL -936
 8301 VTAB 21: TAB RPOS*2+2
 8302 POKE 50,127: PRINT " ": POKE 50,255
 8303 VTAB 24: TAB 7
 8304 PRINT "REACTOR CORE - CONTROL RODS";
 8309 RETURN 
 8310 VTAB 22: TAB 1: PRINT "TEMP=";TEMP;"  ";
 8312 TAB 20: PRINT "CNT=";CNT: RETURN 
 8400 CALL -936: VTAB 22: TAB 15
 8402 PRINT "STU";
 8403 TAB 29: PRINT "VWX"
 8405 VTAB 24: TAB 12
 8406 PRINT "PUMP HOUSE - PUMPS";
 8407 LAB=1: RETURN 
 8410 CALL -936: VTAB 22: TAB 20: PRINT "S";
 8413 TAB 39: PRINT "H"
 8415 VTAB 24: TAB 11
 8416 PRINT "PUMP HOUSE - VALVES";
 8417 LAB=2: RETURN 
 8500 VTAB 22: TAB 1: CALL -958
 8501 PRINT "THE PUBLIC UTILITIES COMMISSION WILL"
 8503 PRINT "ACCEPT A PETITION FOR A RATE INCREASE."
 8504 RETURN 
 8510 VTAB 22: TAB 1: CALL -958
 8512 PRINT "PETITION DENIED.": RETURN 
 8520 VTAB 22: TAB 1: CALL -958
 8522 PRINT "PETITION APPROVED !": RETURN 
 8600 CALL -936
 8601 PRINT "MAINTENANCE SCHEDULE FOR PUMPS": PRINT 
 8603 PRINT "PU/STATUS     TIME  PU/STATUS     TIME"
 8604 PRINT LN$(1,18);"  ";LN$(1,18)
 8605 RETURN 
 8610 CALL -936
 8611 PRINT "MAINTENANCE SCHEDULE FOR VALVES": PRINT 
 8613 PRINT "VA/STATUS     TIME  VA/STATUS     TIME"
 8614 PRINT LN$(1,18);"  ";LN$(1,18)
 8619 RETURN 
 8620 CALL -936
 8621 PRINT "MAINTENANCE SCHEDULE FOR TURBINES": PRINT 
 8623 PRINT "TU/STATUS       TIME"
 8624 PRINT LN$(1,20): RETURN 
 8700 VTAB 1: TAB 15: PRINT "COST ANALYSIS"
 8715 VTAB 5: TAB 1
 8720 PRINT "OPERATING COST:   $ ";COST;",000": PRINT 
 8730 PRINT "MAINTENANCE COST: $ ";MAIN;: IF MAIN THEN PRINT ",000";: PRINT : PRINT : PRINT : CALL -868
 8740 PRINT "ELECTRIC DEMAND: ";DMND;: TAB 24: PRINT "MEGAWATTS": PRINT : CALL -868
 8750 PRINT "ELECTRIC OUTPUT: ";EOUT;: TAB 24: PRINT "MEGAWATTS": PRINT : CALL -868
 8755 PRINT "(ELECTRIC DEMAND CHANGES AT ";:C=SCNT+DCNT: GOSUB 3710: PRINT " )": PRINT : PRINT : CALL -868
 8760 PRINT "PROJECTED PROFIT: $ ";MAXP;: CALL -868: IF MAXP THEN PRINT ",000";: PRINT : PRINT 
 8767 PRINT "ACTUAL PROFIT:  ";: CALL -868
 8769 IF ACTP<0 THEN PRINT "< ";
 8770 TAB 19: PRINT "$ "; ABS (ACTP);: IF ACTP THEN PRINT ",000";: IF ACTP>=0 THEN 8785
 8780 PRINT " >";: TAB 33: PRINT "<LOSS>"
 8785 CALL -958: RETURN 
 8800 TAB 12: PRINT "OPERATIONAL STATUS"
 8802 FOR I=1 TO 10
 8803 VTAB I*2+1: GOTO 8810+I
 8811 PRINT "CORE TEMP:": GOTO 8850
 8812 PRINT "CTRL RODS:": GOTO 8850
 8813 PRINT "PCS PRES:": GOTO 8850
 8814 PRINT "PMPS REQ'D:": GOTO 8850
 8815 PRINT "CNTMT PRES:": GOTO 8850
 8816 PRINT "CNTMT WTR:": GOTO 8850
 8817 PRINT "PMP HSE WTR:": GOTO 8850
 8818 PRINT "PMP HSE RAD:": GOTO 8850
 8819 PRINT "FLUSH TIME:": GOTO 8850
 8820 PRINT "PRSZER WTR:": GOTO 8850
 8850 NEXT I: RETURN 
10000 COLOR=15
10010 FOR Y=39 TO 7 STEP -1
10020 HLIN 2,37 AT Y: NEXT Y
10030 HLIN 0,39 AT 6: HLIN 0,39 AT 5
10040 HLIN 2,37 AT 4
10050 HLIN 5,34 AT 3
10060 HLIN 8,31 AT 2
10070 HLIN 11,28 AT 1
10080 HLIN 14,25 AT 0
10099 RETURN 
10100 X=10:Y=19
10105 FOR I=1 TO 6
10107 X0=I MOD 2
10109 R=I+(I-1)/2
10110 COLOR=CRC(R): IF X0 THEN PLOT X,Y
10112 COLOR=FR(R): PLOT X+X0,Y
10114 COLOR=CRC(R+1): PLOT X+1+X0,Y
10116 COLOR=FR(R+1): IF NOT X0 THEN PLOT X+2,Y
10120 COLOR=FR(R+9): IF X0 THEN PLOT X+3,Y
10122 COLOR=CRC(R+9): PLOT X+3+X0,Y
10124 COLOR=FR(R+10): PLOT X+4+X0,Y
10126 COLOR=CRC(R+10): IF NOT X0 THEN PLOT X+5,Y
10130 Y=Y+1: NEXT I
10135 COLOR=8
10140 C=(CCR(1)#0)*6
10145 VLIN 19-C,24-C AT 11
10150 C=(CCR(2)#0)*6
10155 VLIN 19-C,24-C AT 14
10160 RETURN 
10200 IF DYN#0 THEN RETURN 
10201 COLOR=0: HLIN 20,22 AT 16: HLIN 24,26 AT 16
10202 VLIN 7,15 AT 26: PLOT 27,6: PLOT 26,5: PLOT 25,4: PLOT 24,3
10203 PLOT 22,3: PLOT 21,4: PLOT 20,5: PLOT 19,6: VLIN 7,15 AT 20
10210 C=BU(3): FOR Y=15 TO 4 STEP -1
10215 COLOR=11: IF C>15-Y THEN COLOR=2
10220 IF Y=5 OR Y>6 THEN HLIN 21,25 AT Y
10225 IF Y=6 THEN HLIN 20,26 AT Y
10235 IF Y=4 THEN HLIN 22,24 AT Y
10240 NEXT Y: RETURN 
10300 IF DYN THEN RETURN 
10301 COLOR=0: VLIN 8,19 AT 28: PLOT 29,7: PLOT 30,6
10302 HLIN 31,33 AT 5: PLOT 34,6: PLOT 35,7: PLOT 36,8
10303 VLIN 10,13 AT 36: VLIN 15,19 AT 36
10305 COLOR=14: IF BU(4) THEN COLOR=10
10310 HLIN 31,33 AT 6
10315 COLOR=14: IF BU(4)>1 THEN COLOR=10
10320 HLIN 30,34 AT 7
10325 FOR Y=8 TO 16
10330 COLOR=14: IF BU(4)>Y-6 THEN COLOR=10
10335 HLIN 29,35 AT Y: NEXT Y
10340 COLOR=14: IF BU(4)>11 THEN COLOR=10
10345 PLOT 29,17: PLOT 35,17
10350 COLOR=14: IF BU(4)>12 THEN COLOR=10
10355 PLOT 29,18: HLIN 31,33 AT 18: PLOT 35,18
10360 COLOR=14: IF BU(4)>13 THEN COLOR=10
10365 PLOT 29,19: HLIN 31,33 AT 19: PLOT 35,19
10370 RETURN 
10400 COLOR=0
10402 VLIN 22,29 AT 28: HLIN 28,31 AT 30
10404 HLIN 33,36 AT 30: VLIN 21,29 AT 36
10406 HLIN 28,29 AT 20: HLIN 31,33 AT 20: HLIN 35,36 AT 20
10410 COLOR=2
10415 FOR Y=21 TO 29
10420 HLIN 29,35 AT Y: NEXT Y
10440 HLIN 30,34 AT 17
10450 VLIN 17,20 AT 30
10460 VLIN 17,20 AT 34
10499 RETURN 
10500 COLOR=2
10505 FOR Y=23 TO 26
10510 HLIN 22,26 AT Y: NEXT Y
10599 RETURN 
10600 IF DYN#0 THEN RETURN 
10605 COLOR=15
10610 HLIN 8,31 AT 2
10615 HLIN 11,28 AT 1
10620 HLIN 14,25 AT 0
10635 COLOR=11
10637 C=BU(1)
10640 IF C<10 THEN GOTO 10670-C
10660 HLIN 9,17 AT 2
10661 HLIN 26,30 AT 2
10662 HLIN 18,22 AT 2
10663 HLIN 12,15 AT 1
10664 HLIN 16,19 AT 1
10665 HLIN 20,23 AT 1
10666 HLIN 24,27 AT 1
10667 HLIN 15,17 AT 0
10668 HLIN 18,21 AT 0
10669 HLIN 22,24 AT 0
10670 COLOR=15
10672 HLIN 2,37 AT 39
10674 HLIN 2,37 AT 38
10676 COLOR=2
10677 C=BU(7)
10678 IF C<10 THEN GOTO 10690-C
10680 HLIN 3,8 AT 38
10681 HLIN 9,15 AT 38
10682 HLIN 16,22 AT 38
10683 HLIN 23,29 AT 38
10684 HLIN 30,36 AT 38
10685 HLIN 31,36 AT 39
10686 HLIN 3,9 AT 39
10687 HLIN 24,30 AT 39
10688 HLIN 10,16 AT 39
10689 HLIN 17,23 AT 39
10690 RETURN 
10700 IF DYN THEN RETURN 
10702 COLOR=0: VLIN 19,26 AT 7: HLIN 7,18 AT 27: VLIN 19,26 AT 18
10704 VLIN 9,17 AT 7: PLOT 8,8: HLIN 9,10 AT 7: HLIN 11,14 AT 6
10706 HLIN 15,16 AT 7: PLOT 17,8: VLIN 9,17 AT 18
10710 COLOR=2: VLIN 19,26 AT 8
10715 VLIN 19,26 AT 9
10720 HLIN 9,16 AT 26
10725 HLIN 9,16 AT 25
10730 VLIN 19,26 AT 16
10735 VLIN 19,26 AT 17
10740 FOR I=1 TO 12
10745 COLOR=10: IF BU(2)>=I THEN COLOR=2: IF BU(5)>12-I THEN COLOR=11
10750 IF I>6 THEN GOTO 10760
10751 HLIN 8,10 AT 19-I
10752 IF NOT CCR(1) THEN PLOT 11,19-I
10753 HLIN 12,13 AT 19-I
10754 IF NOT CCR(2) THEN PLOT 14,19-I
10755 HLIN 15,17 AT 19-I
10756 GOTO 10769
10760 IF I<11 THEN HLIN 8,17 AT 19-I
10761 IF I=11 THEN HLIN 9,16 AT 8
10762 IF I=12 THEN HLIN 11,14 AT 7
10769 NEXT I
10770 P=3
10772 IF BU(2) OR PI(P)=10 THEN 10774:PI(P)=10: GOTO 10775
10774 IF NOT BU(2) OR PI(P)#10 THEN RETURN :PI(P)=2
10775 GOSUB 16000: RETURN 
10900 FOR P=1 TO 12: GOSUB 16000: NEXT P
10910 FOR V=1 TO 8: GOSUB 14000: NEXT V
10920 FOR U=1 TO 6: GOSUB 15000: NEXT U
10999 RETURN 
11000 COLOR=15
11005 VLIN 4,39 AT 0
11010 VLIN 4,39 AT 1
11015 VLIN 5,6 AT 2
11020 VLIN 5,6 AT 3
11099 RETURN 
11100 IF DYN#1 THEN RETURN : COLOR=15
11105 HLIN 10,24 AT 14: COLOR=5
11106 VLIN 7,12 AT 13
11107 VLIN 7,12 AT 17
11108 VLIN 7,12 AT 21
11110 COLOR=TU(1)
11115 VLIN 8,13 AT 10
11120 VLIN 7,13 AT 11
11125 VLIN 6,13 AT 12
11129 COLOR=TU(2)
11130 VLIN 6,13 AT 14
11135 VLIN 6,13 AT 15
11140 VLIN 6,13 AT 16
11144 COLOR=TU(3)
11145 VLIN 6,13 AT 18
11150 VLIN 6,13 AT 19
11155 VLIN 6,13 AT 20
11159 COLOR=TU(4)
11160 VLIN 6,13 AT 22
11165 VLIN 7,13 AT 23
11170 VLIN 8,13 AT 24
11199 RETURN 
11200 IF DYN#1 THEN RETURN 
11205 FOR Y=15 TO 16
11210 COLOR=7: IF BU(6)>Y-15 THEN COLOR=10
11215 HLIN 12,22 AT Y: NEXT Y
11220 COLOR=7: IF BU(6)>2 THEN COLOR=10
11225 PLOT 12,17
11230 COLOR=7: IF BU(6)>3 THEN COLOR=10
11235 PLOT 12,18: HLIN 14,22 AT 18
11240 COLOR=7: IF BU(6)>4 THEN COLOR=10
11245 PLOT 12,19
11250 FOR Y=20 TO 21
11255 COLOR=7: IF BU(6)>Y-15 THEN COLOR=10
11260 HLIN 12,22 AT Y: NEXT Y
11265 FOR Y=22 TO 24
11270 COLOR=7: IF BU(6)>Y-15 THEN COLOR=10
11275 HLIN 12,19 AT Y: NEXT Y
11299 RETURN 
11300 IF DYN#1 THEN RETURN 
11301 COLOR=FI(1)
11305 HLIN 6,7 AT 32
11306 HLIN 5,8 AT 33
11307 HLIN 4,9 AT 34
11308 HLIN 5,8 AT 35
11309 HLIN 6,7 AT 36
11310 COLOR=FI(2)
11311 HLIN 12,13 AT 32
11312 HLIN 11,14 AT 33
11313 HLIN 10,15 AT 34
11314 HLIN 11,14 AT 35
11315 HLIN 12,13 AT 36
11320 COLOR=FI(3)
11321 HLIN 18,19 AT 32
11322 HLIN 17,20 AT 33
11323 HLIN 16,21 AT 34
11324 HLIN 17,20 AT 35
11325 HLIN 18,19 AT 36
11350 COLOR=3
11351 FOR I=1 TO 3
11352 J=SL(I): IF J>10 THEN J=10
11353 X=I*6
11354 GOTO 11371-J
11361 PLOT X,33
11362 PLOT X+1,33
11363 PLOT X-1,34
11364 PLOT X,34
11365 PLOT X+1,34
11366 PLOT X+2,34
11367 PLOT X-1,35
11368 PLOT X,35
11369 PLOT X+1,35
11370 PLOT X+2,35
11371 NEXT I
11399 RETURN 
11400 COLOR=15
11405 FOR X=32 TO 37
11410 VLIN 0,25 AT X: NEXT X
11415 VLIN 1,3 AT 30
11420 VLIN 0,6 AT 31
11425 VLIN 0,6 AT 38
11430 VLIN 1,3 AT 39
11435 VLIN 22,25 AT 30
11436 VLIN 19,25 AT 31
11437 VLIN 19,25 AT 38
11438 VLIN 22,25 AT 39
11440 VLIN 19,24 AT 31
11445 VLIN 19,24 AT 38
11450 VLIN 22,24 AT 39
11455 COLOR=6
11460 FOR Y=26 TO 31
11465 HLIN 30,39 AT Y: NEXT Y
11499 RETURN 
11500 COLOR=2
11505 FOR Y=34 TO 39
11510 HLIN 34,39 AT Y: NEXT Y
11599 RETURN 
11600 IF DYN#1 THEN RETURN 
11605 COLOR=13
11606 AIR=1
11607 PI(24)=13
11610 IF VA(13)=12 OR VA(14)=12 OR VA(15)=12 THEN 11625
11615 COLOR=10
11616 AIR=0
11617 PI(24)=10
11620 FCNT=FF0
11625 HLIN 6,8 AT 27
11630 HLIN 6,8 AT 28
11635 HLIN 6,19 AT 29
11640 PLOT 7,30
11645 PLOT 13,30
11650 PLOT 19,30
11699 RETURN 
11700 COLOR=2
11705 FOR Y=16 TO 19
11710 HLIN 6,10 AT Y
11715 NEXT Y
11720 RETURN 
11900 P=1: GOSUB 16100
11905 P=2: GOSUB 16100
11910 FOR P=13 TO 22: GOSUB 16100: NEXT P
11920 V=2: GOSUB 14100
11925 V=3: GOSUB 14100
11930 FOR V=9 TO 18: GOSUB 14100: NEXT V
11940 FOR U=7 TO 18: GOSUB 15100: NEXT U
11999 RETURN 
12000 COLOR=2
12005 VLIN 5,39 AT 0
12010 VLIN 5,39 AT 1
12012 VLIN 5,39 AT 2
12015 HLIN 2,37 AT 38
12020 HLIN 2,37 AT 39
12025 VLIN 5,39 AT 38
12030 VLIN 5,39 AT 39
12035 RETURN 
12100 COLOR=15
12105 FOR Y=36 TO 5 STEP -2
12110 PLOT 1,Y: NEXT Y: RETURN 
12200 IF DYN#2 THEN RETURN 
12210 FOR Y=4 TO 0 STEP -1
12215 COLOR=2
12220 IF BU(2)<5-Y THEN COLOR=10
12225 IF BU(5)>7+Y THEN COLOR=11
12230 HLIN 0,2 AT Y: FOR X=4 TO 37 STEP 2: PLOT X,Y: NEXT X: HLIN 38,39 AT Y
12235 NEXT Y: RETURN 
12900 FOR R=1 TO 18
12905 GOSUB 3050
12915 COLOR=FR(R)
12920 IF R<18 THEN VLIN 5,37 AT R*2+2
12950 NEXT R: RETURN 
13000 COLOR=15
13005 VLIN 4,39 AT 38
13010 VLIN 4,39 AT 39
13015 VLIN 5,6 AT 37
13020 VLIN 5,6 AT 36
13099 RETURN 
13100 COLOR=14
13105 HLIN 16,20 AT 2
13110 VLIN 3,17 AT 17
13115 VLIN 3,17 AT 18
13120 VLIN 3,17 AT 19
13125 HLIN 0,35 AT 18
13130 HLIN 0,35 AT 19
13135 FOR Y=20 TO 39
13140 HLIN 2,33 AT Y: NEXT Y: RETURN 
13200 IF DYN#3 THEN RETURN 
13202 COLOR=0
13205 HLIN 22,31 AT 26
13210 VLIN 27,34 AT 31: PLOT 31,36
13215 HLIN 22,31 AT 37
13220 VLIN 27,36 AT 22
13225 FOR I=1 TO 10
13230 COLOR=10: IF BU(8)/5>=I THEN COLOR=2
13235 IF I>3 THEN HLIN 23,30 AT 37-I
13240 IF I<=3 THEN HLIN 23,27 AT 37-I
13245 NEXT I: RETURN 
13300 IF DYN#3 THEN RETURN 
13310 COLOR=0: HLIN 5,17 AT 20: VLIN 21,33 AT 17: PLOT 17,35
13315 HLIN 4,17 AT 36
13320 VLIN 20,35 AT 4
13325 FOR I=1 TO 15
13330 COLOR=10: IF BU(9)/5>=I THEN COLOR=2
13335 IF I>3 THEN HLIN 5,16 AT 36-I
13340 IF I<=3 THEN HLIN 5,13 AT 36-I
13345 NEXT I: RETURN 
13400 IF DYN#3 THEN RETURN 
13402 COLOR=14
13405 HLIN 2,33 AT 38: HLIN 2,33 AT 39
13410 C=BU(10)
13412 COLOR=2
13415 IF C<10 THEN GOTO 13430-C
13420 HLIN 3,4 AT 38: PLOT 32,38
13421 HLIN 5,7 AT 38: HLIN 30,31 AT 38
13422 HLIN 8,10 AT 38: HLIN 28,29 AT 38
13423 HLIN 11,13 AT 38: HLIN 25,27 AT 38
13424 HLIN 14,17 AT 38: HLIN 22,24 AT 38
13425 HLIN 17,21 AT 38
13426 HLIN 3,6 AT 39: HLIN 30,32 AT 39
13427 HLIN 7,11 AT 39: HLIN 27,29 AT 39
13428 HLIN 12,16 AT 39: HLIN 22,26 AT 39
13429 HLIN 17,21 AT 39
13430 RETURN 
13500 IF DYN#3 THEN RETURN 
13505 COLOR=0
13510 HLIN 0,39 AT 0: HLIN 0,39 AT 1
13512 COLOR=11
13515 C=BU(11)/10: IF C<15 THEN GOTO 13535-C
13520 HLIN 36,39 AT 1
13521 HLIN 31,35 AT 1
13522 HLIN 0,5 AT 1
13523 HLIN 26,30 AT 1
13524 HLIN 6,10 AT 1
13525 HLIN 21,25 AT 1
13526 HLIN 11,15 AT 1
13527 HLIN 16,20 AT 1
13528 HLIN 0,5 AT 0
13529 HLIN 35,39 AT 0
13530 HLIN 6,10 AT 0
13531 HLIN 28,34 AT 0
13532 HLIN 11,15 AT 0
13533 HLIN 22,27 AT 0
13534 HLIN 16,21 AT 0
13535 RETURN 
13900 P=12: GOSUB 16300
13905 P=23: GOSUB 16300
13910 V=8: GOSUB 14300
13915 V=19: GOSUB 14300
13920 FOR U=19 TO 24
13925 GOSUB 15300: NEXT U: RETURN 
14000 IF DYN#0 OR V<1 OR V>8 THEN RETURN : COLOR=VA(V): GOTO 14000+V
14001 PLOT 23,3: RETURN 
14002 PLOT 37,9: RETURN 
14003 PLOT 37,14: RETURN 
14004 PLOT 15,29: RETURN 
14005 PLOT 13,32: RETURN 
14006 PLOT 11,34: RETURN 
14007 PLOT 9,36: RETURN 
14008 PLOT 2,35: RETURN 
14100 IF DYN#1 THEN RETURN : IF V#2 AND V#3 AND (V<9 OR V>18) THEN RETURN : COLOR=VA(V): GOTO 14100+V
14102 PLOT 1,9: RETURN 
14103 PLOT 1,14: RETURN 
14109 PLOT 9,22: RETURN 
14110 PLOT 9,24: RETURN 
14111 PLOT 28,29: RETURN 
14112 PLOT 27,31: RETURN 
14113 PLOT 7,31: RETURN 
14114 PLOT 13,31: RETURN 
14115 PLOT 19,31: RETURN 
14116 PLOT 6,37: RETURN 
14117 PLOT 12,37: RETURN 
14118 PLOT 18,37: RETURN 
14300 IF DYN#3 THEN RETURN : IF V#8 AND V#19 THEN RETURN : COLOR=VA(V): GOTO 14300+V
14308 PLOT 38,35: RETURN 
14319 PLOT 19,34: RETURN 
15000 IF DYN#0 THEN RETURN : IF U<1 OR U>6 THEN RETURN : COLOR=PU(U): GOTO 15000+U
15001 VLIN 24,26 AT 24: RETURN 
15002 VLIN 24,26 AT 25: RETURN 
15003 VLIN 24,26 AT 26: RETURN 
15004 VLIN 27,29 AT 31: RETURN 
15005 VLIN 27,29 AT 32: RETURN 
15006 VLIN 27,29 AT 33: RETURN 
15100 IF DYN#1 THEN RETURN : IF U<7 OR U>18 THEN RETURN : COLOR=PU(U): GOTO 15100+U
15107 VLIN 17,19 AT 8: RETURN 
15108 VLIN 17,19 AT 9: RETURN 
15109 VLIN 17,19 AT 10: RETURN 
15110 VLIN 22,24 AT 20: RETURN 
15111 VLIN 22,24 AT 21: RETURN 
15112 VLIN 22,24 AT 22: RETURN 
15113 VLIN 29,31 AT 30: RETURN 
15114 VLIN 29,31 AT 31: RETURN 
15115 VLIN 29,31 AT 32: RETURN 
15116 VLIN 37,39 AT 34: RETURN 
15117 VLIN 37,39 AT 35: RETURN 
15118 VLIN 37,39 AT 36: RETURN 
15300 IF DYN#3 OR U<19 OR U>24 THEN RETURN : COLOR=PU(U): GOTO 15300+U
15319 VLIN 33,35 AT 14: RETURN 
15320 VLIN 33,35 AT 15: RETURN 
15321 VLIN 33,35 AT 16: RETURN 
15322 VLIN 34,36 AT 28: RETURN 
15323 VLIN 34,36 AT 29: RETURN 
15324 VLIN 34,36 AT 30: RETURN 
16000 IF DYN#0 OR P<1 OR P>12 THEN RETURN : COLOR=PI(P): GOTO 16000+P
16001 HLIN 36,39 AT 9: RETURN 
16002 HLIN 36,39 AT 14: RETURN 
16003 HLIN 18,22 AT 18: VLIN 16,21 AT 23: HLIN 24,28 AT 21: RETURN 
16004 VLIN 30,36 AT 32: RETURN 
16005 HLIN 6,31 AT 32: RETURN 
16006 HLIN 6,31 AT 34: RETURN 
16007 HLIN 6,31 AT 36: RETURN 
16008 VLIN 30,36 AT 5: RETURN 
16009 VLIN 19,29 AT 5: HLIN 5,7 AT 18: RETURN 
16010 VLIN 27,29 AT 25: RETURN 
16011 HLIN 6,24 AT 29: RETURN 
16012 HLIN 0,3 AT 35: VLIN 35,37 AT 3: RETURN 
16100 IF DYN#1 THEN RETURN : IF P#1 AND P#2 AND (P<13 OR P>22) THEN RETURN : COLOR=PI(P): GOTO 16100+P
16101 HLIN 0,9 AT 9: RETURN 
16102 HLIN 0,3 AT 14: RETURN 
16113 VLIN 15,24 AT 3: RETURN 
16114 HLIN 4,9 AT 22: RETURN 
16115 HLIN 4,9 AT 24: RETURN 
16116 VLIN 25,34 AT 3: RETURN 
16117 VLIN 19,31 AT 25: HLIN 13,24 AT 19: PLOT 13,18: HLIN 13,27 AT 17: VLIN 18,25 AT 27: HLIN 27,29 AT 26: RETURN 
16118 VLIN 25,34 AT 22: RETURN 
16119 HLIN 6,33 AT 39: PLOT 6,38: PLOT 12,38: PLOT 18,38: RETURN 
16120 VLIN 20,24 AT 10: RETURN 
16121 HLIN 26,29 AT 29: RETURN 
16122 HLIN 26,29 AT 31: RETURN 
16300 IF DYN#3 THEN RETURN : IF P#12 AND P#23 THEN RETURN : COLOR=PI(P): GOTO 16300+P
16312 HLIN 31,39 AT 35: VLIN 35,37 AT 39: RETURN 
16323 HLIN 17,19 AT 34: VLIN 34,37 AT 19: RETURN 
20000 TEXT : CALL -936
20002 TAB 10: PRINT "OFFICIAL NOTIFICATION": PRINT : PRINT 
20006 PRINT "FROM: PUBLIC UTILITIES COMMISSION": PRINT 
20010 PRINT "TO  : MANAGER, THREE MILE ISLAND": PRINT 
20014 PRINT "RE  : EXCESSIVE LOSSES FROM OPERATIONS": PRINT : PRINT : PRINT 
20018 PRINT "PLEASE BE ADVISED THAT DUE TO YOUR": PRINT 
20022 PRINT "DEMONSTRATED OPERATIONAL INCOMPETENCE,": PRINT 
20026 PRINT "THE PUBLIC UTILITIES COMMISSION IS": PRINT 
20030 PRINT "FORCED TO RELIEVE YOU OF YOUR LICENSE": PRINT 
20034 PRINT "TO OPERATE, EFFECTIVE IMMEDIATELY."
20036 POP : POP : END 
20100 V=2: IF VA(V)#1 THEN GOSUB 2110
20101 V=3: IF VA(V)#1 THEN GOSUB 2110
20102 V=8: IF VA(V)#1 THEN GOSUB 2110
20103 GOSUB 20500: GOSUB 20700
20120 PRINT "THE CONTAINMENT HAS JUST SEALED": PRINT 
20140 PRINT "ITSELF AS A RESULT OF EXCESSIVE": PRINT 
20160 PRINT "PRESSURE DUE TO STEAM ESCAPING FROM": PRINT 
20180 PRINT "PRESSURIZER RELIEF VALVE A."
20190 GOSUB 20400:CP=32767: POKE -16368,0: RETURN 
20200 GOSUB 20700
20220 PRINT "THE EMERGENCY CORE COOLING SYSTEM": PRINT 
20230 PRINT "HAS BEEN ACTIVATED TO RE-ESTABLISH": PRINT 
20240 PRINT "THE REQUIRED PRESSURE IN THE CORE": PRINT 
20250 PRINT "VESSEL."
20255 POKE -16368,0: RETURN 
20300 FOR F=1 TO 3
20301 C=10: GOSUB 2720: NEXT F
20303 FOR U=7 TO 9
20304 IF PU(U)=1 THEN GOSUB 2010
20305 NEXT U
20306 FCNT=32767: GOSUB 20500: GOSUB 20700
20320 PRINT "THE EMERGENCY SECONDARY COOLING SYSTEM": PRINT 
20330 PRINT "HAS BEEN ACTIVATED TO PROVIDE WATER": PRINT 
20340 PRINT "DIRECTLY TO THE STEAMER."
20345 GOSUB 20400: POKE -16368,0: RETURN 
20400 VTAB 20: CALL -868
20410 POKE 50,127: PRINT "REACTOR HAS BEEN SCRAMMED": POKE 50,255
20425 FOR R=1 TO 18:CR(R)=0: NEXT R
20430 TMP0=0:CCR(1)=0:CCR(2)=0: RETURN 
20500 FOR I=1 TO 15: CALL BELL: NEXT I: RETURN 
20600 GOSUB 20500: GOSUB 20700
20605 PRINT "EXCESSIVE PRESSURE IN THE PRIMARY CORE": PRINT 
20615 PRINT "COOLING SYSTEM HAS CAUSED A LEAK."
20650 LEAK=1: POKE -16368,0: RETURN 
20700 TEXT : CALL -936: IF DYN>=0 THEN DYN=10
20720 POKE 50,127
20725 TAB 8: PRINT "EMERGENCY";
20730 TAB 18: PRINT "NOTICE";
20740 TAB 25: PRINT "NUMBER";
20750 TAB 32:ENN=ENN+1: PRINT ENN
20760 POKE 50,255: PRINT : PRINT : RETURN 
20800 GOSUB 20500: GOSUB 20700
20805 PRINT "EXTREME DANGER TO ALL PEOPLE IN ";RAD1: PRINT 
20815 PRINT "MILE AREA SURROUNDING THE REACTOR.  AN": PRINT 
20820 PRINT "IMMEDIATE EVACUATION IS NOW REQUIRED": PRINT 
20830 PRINT "TO LIMIT THE POTENTIAL INCREASE IN": PRINT 
20840 PRINT "FUTURE LIABILITY INSURANCE PREMIUMS."
20845 RAD1=RAD1+50: POKE -16368,0: RETURN 
20900 GOSUB 20500: GOSUB 20700
20910 PRINT "RAPID DIS-ASSEMBLY HAS REDUCED": PRINT 
20920 PRINT "PRESSURE IN ";: IF BU(5)>RD5 THEN 20940
20930 PRINT "CONTAINMENT.":BU(1)=BU(1)/2: GOTO 20950
20940 PRINT "REACTOR CORE VESSEL":BU(5)=BU(5)/2
20950 POKE -16368,0: RETURN 
21000 TEXT : CALL -936: IF DYN>=0 THEN DYN=10
21010 POKE 50,127
21020 TAB 8: PRINT "SAFETY";
21030 TAB 15: PRINT "DIRECTIVE";
21040 TAB 25: PRINT "NUMBER";
21050 TAB 32:SDN=SDN+1: PRINT SDN
21060 POKE 50,255: PRINT : PRINT : RETURN 
21100 GOSUB 20500: GOSUB 21000
21102 PRINT "FROM: MUSE SAFETY ADVISORY BOARD": PRINT 
21104 PRINT "TO  : MANAGER, THREE MILE ISLAND": PRINT 
21106 IF GMAIN THEN 21150
21108 PRINT "RE  : ACCURACY OF GAUGES": PRINT : PRINT 
21110 PRINT "UPDATED COMPUTER TESTS HAVE UNCOVERED": PRINT 
21112 PRINT "SUSPECTED DEFECTS IN THE 'OPERATIONAL": PRINT 
21114 PRINT "STATUS' GAUGES, CAUSING ERRONEOUS": PRINT 
21116 PRINT "READINGS.": PRINT : PRINT 
21118 PRINT "YOU ARE HEREBY REQUESTED TO SUBMIT": PRINT 
21120 PRINT "ALL GAUGES TO INSPECTION.  WILL YOU": PRINT 
21122 PRINT "COMPLY (Y OR N) ?";: POKE -16368,0
21124 KB= PEEK (-16384): IF KB<128 THEN 21124
21128 POKE -16368,0:GC(11)=GC1: IF KB# ASC("Y") THEN RETURN 
21130 GMAIN=1:GC(11)=GC1:MAIN=MAIN+ RND (GM1)+GM0
21132 NDG=0: FOR I=1 TO 9:NDG=NDG+( NOT GC(I)): NEXT I: RETURN 
21150 PRINT "RE:   INSPECTION OF GAUGES": PRINT : PRINT 
21152 PRINT "LASER AND PARTICLE BEAM ANALYSIS OF": PRINT 
21154 PRINT "'OPERATION STATUS' GAUGES HAS REVEALED": PRINT 
21156 PRINT "THAT ";NDG;" GAUGES WERE DEFECTIVE.": PRINT : PRINT 
21157 IF NOT NDG THEN 21162
21158 PRINT "DEFECTIVE GAUGES HAVE BEEN REPAIRED": PRINT 
21160 PRINT "AND ARE FULLY FUNCTIONAL."
21162 GMAIN=0
21164 FOR I=1 TO 10:GC(I)=GC0+ RND (GC1): NEXT I
21166 GC(11)=GC0: POKE -16368,0: RETURN 
21200 POKE 50,63: VTAB 10: TAB 1
21210 PRINT SP$(1,20): PRINT SP$(1,20)
21220 PRINT " GAUGES UNAVAILABLE "
21225 PRINT SP$(1,20)
21230 PRINT " DURING INSPECTION. "
21240 PRINT SP$(1,20): PRINT SP$(1,20)
21250 POKE 50,255: POP : RETURN 
22000 GOSUB 20700
22005 VTAB 12: TAB 15
22010 POKE 50,127: PRINT "MELT-DOWN": POKE 50,255
22015 FOR J=1 TO 3: GOSUB 20500: NEXT J
22050 GR : CALL -936:DYN=0
22055 GOSUB 10000: GOSUB 10600: GOSUB 10700: GOSUB 10100
22060 GOSUB 10200: GOSUB 10300: GOSUB 10400: GOSUB 10500: GOSUB 10900
22065 COLOR=1
22070 FOR Y=19 TO 47: HLIN 10,15 AT Y: GOSUB 22100: NEXT Y
22075 PLOT RND (40), RND (48): GOSUB 22100: GOTO 22075
22100 POKE -16299,0: POKE -16302,0: POKE -16304,0: CALL BELL
22105 POKE -16300,0: POKE -16302,0: POKE -16304,0: CALL BELL
22110 POKE -16297,0: POKE -16302,0: CALL BELL
22115 POKE -16298,0: RETURN 
32000 SP$="                              "
32050 LN$="------------------------------"
32055 LET$="ABCDEFGHIJKLMNOPQRSTUVWXYZ"
32060 CMMD$=""
32065 CMMD=0:CHAR=1:CCNT=0
32200 VP(1)=0:VP(2)=1
32201 VP(3)=2:VP(4)=11
32202 VP(5)=5:VP(6)=6
32203 VP(7)=7:VP(8)=12
32204 VP(9)=14:VP(10)=15
32205 VP(11)=21:VP(12)=22
32206 VP(13)=24:VP(14)=24
32207 VP(15)=24:VP(16)=19
32208 VP(17)=19:VP(18)=19
32209 VP(19)=23
32210 CX(1)=10:CX(2)=12:CX(3)=11
32211 CX(4)=10:CX(5)=12:CX(6)=11
32212 CX(7)=10:CX(8)=12:CX(9)=11
32213 CX(10)=14:CX(11)=13:CX(12)=15
32214 CX(13)=14:CX(14)=13:CX(15)=15
32215 CX(16)=14:CX(17)=13:CX(18)=15
32220 CY(1)=19:CY(2)=19:CY(3)=20
32221 CY(4)=21:CY(5)=21:CY(6)=22
32222 CY(7)=23:CY(8)=23:CY(9)=24
32223 CY(10)=19:CY(11)=20:CY(12)=20
32224 CY(13)=21:CY(14)=22:CY(15)=22
32225 CY(16)=23:CY(17)=24:CY(18)=24
32300 VF0=250:VF1=100
32301 VA0=5:VA1=5
32302 VR0=25:VR1=25
32303 UF0=500:UF1=100
32304 UA0=5:UA1=5
32305 UR0=50:UR1=25
32306 TF0=2760:TF1=120
32307 TA0=10:TA1=10
32308 TR0=100:TR1=100
32309 SR0=25:SR1=25
32310 DC0=50:DC1=15
32311 DM0=75:DM1=25
32312 FF0=120:FCNT=FF0
32313 VM0=1:VM1=1
32314 UM0=2:UM1=2
32315 TM0=5:TM1=5
32316 UC1=0:UC2=0
32317 UC3=0:UC4=0
32318 UC5=0:UC6=0
32319 UC7=0:UC8=0
32320 FC=0:TCNT=0
32321 GC0=750:GC1=50
32322 GM0=10:GM1=10
32400 MAIN=0:COST=200
32401 MAXP=0:ACTP=0
32402 EOUT=0:DMND=100
32403 LOSS1=-200:LOSS2=-500
32404 CP0=50:CP=CP0
32405 FRDMG=0
32406 AIR=0
32407 LK0=100:LEAK=0
32408 RAD1=50
32409 RD5=25:RD1=75
32411 TMPMD=2500
32412 TMP0=0
32413 TMP1=400
32414 TMP2=500
32415 TMP3=600
32416 TMP4=750
32417 TEMP=0
32418 CNT=0:SCNT=0
32419 SYM=1
32420 GMAIN=0:NDG=0
32422 RPOS=9
32423 DCNT=DC0+ RND (DC1)*( RND (3)-1)
32424 SDN=0:ENN=0
32425 DAY=1
32500 FOR P=1 TO 25
32502 PI(P)=10: NEXT P
32504 FOR U=1 TO 24
32506 UC(U)= RND (UF1)+UF0
32508 PU(U)=1: NEXT U
32510 FOR V=1 TO 19
32512 VC(V)= RND (VF1)+VF0
32514 VA(V)=1: NEXT V
32516 FOR B=1 TO 11
32518 BU(B)=0: NEXT B
32520 FOR F=1 TO 3
32522 FI(F)=10:SL(F)=0
32524 SC(F)= RND (SR1)+SR0: NEXT F
32526 FOR T=1 TO 4
32528 TC(T)= RND (TF1)+TF0
32530 TU(T)=10: NEXT T
32532 FOR R=1 TO 18
32534 CR(R)=0:CRC(R)=12: NEXT R
32536 FOR R=1 TO 18
32537 FR(R)=10: NEXT R
32538 FOR G=1 TO 11
32540 GC(G)=GC0+ RND (GC1): NEXT G
32600 FCOL(1)=10:FCOL(2)=7
32601 FCOL(3)=6:FCOL(4)=2
32602 CCR(1)=0:CCR(2)=0
32604 BU(3)=6
32605 BU(2)=12
32606 GC(11)=GC0
32700 CALL -936: PRINT "WELCOME TO ...": VTAB 5: TAB 4
32706 PRINT "THREE MILE ISLAND NUCLEAR FACILITY": VTAB 10
32710 PRINT "THE REACTOR IS IN A COLD SHUT-DOWN": PRINT 
32714 PRINT "STATE WITH ALL SYSTEMS IN-ACTIVE.": PRINT : PRINT 
32718 PRINT "THE DATE IS DECEMBER 30,1978, AND THE": PRINT 
32722 PRINT "REACTOR HAS BEEN CERTIFIED OPERATIONAL.": PRINT : PRINT 
32726 PRINT "INITIALIZE ACCORDING TO OFFICIAL MUSE": PRINT 
32730 PRINT "GUIDELINES (Y OR N) ?"
32732 KB= PEEK (-16384): IF KB<128 THEN 32732: POKE -16368,0
32736 IF KB# ASC("Y") THEN RETURN 
32738 CMMD=1:CCNT=0:CHAR=1
32740 CMMD$="1JMKBCIJABA0DEGFH"
32741 I= LEN(CMMD$)+1
32742 CMMD$(I)="2#6<#30+>#30+>#30+>#30+>#30+>#30+>#30+>"
32743 I= LEN(CMMD$)+1
32744 CMMD$(I)="#30+>#30+>#30+>#30+>#30+>#30+>#30+>#30+#8<:"
32746 RETURN 
